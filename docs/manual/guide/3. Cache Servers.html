<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
        <title>3. Cache Servers</title>
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Ref" charset="utf-8"/>
    </head>
    <body class="body">
    <h1><a name="3. Cache Servers">3. Cache Servers</a></h1>Gemfire supports a client / server mode for caching which can unlock some of the nicer Gemfire features including:
<ul class="star">
<li>Grid computing</li>
<li>Continuous querying</li>
<li>Advanced data partitioning</li>
</ul><p class="paragraph"/>In order to use client/server mode you need to <a href="../guide/single.html#1.1 Installing Gemfire" class="guide">install gemfire</a> as per the documentation.<p class="paragraph"/>This plugin provides scripts to start up cache servers and locators.<p class="paragraph"/>To startup cache servers you can use the <code>start-cache-server</code> command.<p class="paragraph"/><div class="code"><pre>grails start&#45;cache&#45;server server1</pre></div><p class="paragraph"/>You can stop a server again using the <code>stop-cache-server</code> command:<p class="paragraph"/><div class="code"><pre>grails stop&#45;cache&#45;server server1</pre></div><p class="paragraph"/>The port of the server is automatically assigned. If you want to specify the port, locator server or multicast options there are more advanced arguments:<p class="paragraph"/><div class="code"><pre>grails start&#45;cache&#45;server server1 &#45;&#45;locators=localhost&#91;4111&#93; &#45;&#45;port=41112 &#45;&#45;mcast&#45;port=0</pre></div><p class="paragraph"/>If the multicast port (mcast-port) option is set to 0 then multicast is disabled. If you disable multicast then you will need to setup a locator server.<p class="paragraph"/>You can setup a locator by running the <code>start-locator</code> command:<p class="paragraph"/><div class="code"><pre>grails start&#45;locator</pre></div><p class="paragraph"/>This will start the locator on port 55221 by default. If you wish to start the locator service on a different port you can use:<p class="paragraph"/><div class="code"><pre>grails start&#45;locator &#45;&#45;port=4111</pre></div><p class="paragraph"/>A locator is responsible for looking up the location of cache servers. If you don't use a locator then the default multicast lookup will happen.<p class="paragraph"/><h2><a name="3.1 Cache Server Clients">3.1 Cache Server Clients</a></h2>Once you have some cache servers up and running you need to configure the Grails application to act as a client to the servers.<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy
grails.gemfire.servers = &#123;    
	myServer &#123;
		properties = &#91;'log&#45;level': 'warning'&#93;
		pool &#123;
			addServer <span class="java&#45;quote">"localhost"</span>, 4111
			setMinConnections 1
			setMaxConnections 20
			setRetryAttempts 10
			setSubscriptionEnabled <span class="java&#45;keyword">true</span>
		&#125;
	&#125;
&#125;</pre></div><p class="paragraph"/>The example above using a single cache server. If you plan to use multiple cache servers then you can specify one or many locators.<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy
grails.gemfire.servers = &#123;    
	myServer &#123;
		properties = &#91;'log&#45;level': 'warning'&#93;
		pool &#123;
			addLocator <span class="java&#45;quote">"localhost"</span>, 4111
			setMinConnections 1
			setMaxConnections 20
			setRetryAttempts 10
			setSubscriptionEnabled <span class="java&#45;keyword">true</span>
		&#125;
	&#125;
&#125;</pre></div><p class="paragraph"/>If you want to use continuous queries make sure that <code>subscriptionEnabled</code> is set to true on the pool. For all the configuration options see the <a href="http://www.gemstone.com/docs/6.5.0/product/docs/japi/com/gemstone/gemfire/cache/client/class-use/PoolFactory.html" target="blank">PoolFactory</a> API in the Gemfire documentation
    </body>
</html>
