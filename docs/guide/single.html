<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
    <head>
        <title>GemFire Plugin 1.0.0.BUILD-SNAPSHOT</title>
        <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen, print" title="Style" charset="utf-8" />
        <link rel="stylesheet" href="../css/pdf.css" type="text/css" media="print" title="PDF" charset="utf-8" />
    <script type="text/javascript">
function addJsClass(el) {
    var classes = document.body.className.split(" ");
    classes.push("js");
    document.body.className = classes.join(" ");
}
    </script>
    </head>

    <body class="body" onload="addJsClass();">
        <div id="navigation">
            <ul>
                <li>
                    <div id="nav-summary" onmouseover="toggleNavSummary(false)" onmouseout="toggleNavSummary(true)">
                        <a href="../guide/index.html" class="button">Table of contents</a>
                        <div id="nav-summary-childs" style="display:none;">
                            
                            <div class="toc-item" style="margin-left:0"><a href="#1.%20Introduction%20To%20The%20GemFire%20Plugin"><strong>1</strong><span>Introduction To The GemFire Plugin</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#2.%20Cache%20Regions"><strong>2</strong><span>Cache Regions</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0"><a href="#3.%20Cache%20Servers"><strong>3</strong><span>Cache Servers</span></a></div>
                            
                        </div>
                    </div>
                </li>
                <li class="separator selected">
                    <a id="ref-button" onclick="localToggle(); return false;" href="#">Quick Reference</a>
                </li>
            </ul>
        </div>
        <div id="header">
            <div class="images clearfix">
                
                
            </div>
            <p>The Gemfire plugin for Grails provides integration with the [GemFire|http://www.vmware.com/products/application-platform/vfabric-gemfire/overview.html] in-memory distributed data management platform.</p>
        </div>


        <table id="colset" border="0" cellpadding="0" cellspacing="0">
            <tr>
                <td id="col1">
                    <div id="main" class="corner-all">

                        <span id='toggle-col1' class="toggle">(<a href="#" onclick="localToggle(); return false;">Quick Reference</a>)</span>

                        <div class="project">
                            <h1>GemFire Plugin - Reference Documentation</h1>
                            <p><strong>Authors:</strong> Jeff Brown, Graeme Rocher</p>
                            <p><strong>Version:</strong> 1.0.0.BUILD-SNAPSHOT</p>
                            
                        </div>

                        
                        <div id="table-of-content">
                            <h2>Table of Contents</h2>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#1.%20Introduction%20To%20The%20GemFire%20Plugin"><strong>1</strong><span>Introduction To The GemFire Plugin</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#1.1%20Installing%20Gemfire"><strong>1.1</strong><span>Installing Gemfire</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#2.%20Cache%20Regions"><strong>2</strong><span>Cache Regions</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#2.1%20Cache%20Region%20Configuration"><strong>2.1</strong><span>Cache Region Configuration</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#2.2%20Accesing%20Cache%20Regions"><strong>2.2</strong><span>Accesing Cache Regions</span></a></div>
                            
                            <div class="toc-item" style="margin-left:0px"><a href="#3.%20Cache%20Servers"><strong>3</strong><span>Cache Servers</span></a></div>
                            
                            <div class="toc-item" style="margin-left:10px"><a href="#3.1%20Cache%20Server%20Clients"><strong>3.1</strong><span>Cache Server Clients</span></a></div>
                            
                            <div style="clear:both" ></div>
                        </div>
                        
                        

<h1 id="1. Introduction To The GemFire Plugin">1 Introduction To The GemFire Plugin</h1>
The GemFire plugin provides integration with the GemFire in-memory distributed
data management platform.<p class="paragraph"/>This user guide describes details on configuring and using GemFire specifically 
in the context of a Grails application.  Complete documentation on GemFire is
available at <a href="http://www.gemstone.com/products/gemfire" target="blank">http://www.gemstone.com/products/gemfire</a>.



<h2 id="1.1 Installing Gemfire">1.1 Installing Gemfire</h2>
<h4>Installing GemFire</h4><p class="paragraph"/>If you plan to use Gemfire only in peer-2-peer mode then you can skip this installation. If you want to use Gemfire in client/server mode then follow these instructions to install Gemfire:
<ol>
<li>Register at the <a href="http://www.springsource.com/downloads/gemfire-evaluation-download" target="blank">SpringSource GemFire download site</a> to access the download.</li>
</ol><p class="paragraph"/>The registration process is quick and helps us help you later if you have questions or problems. The product includes an evaluation license.
<ol>
<li>Install GemFire Enterprise 6.5 according to the instructions on the download site.</li>
</ol><p class="paragraph"/>You can also get GemFire from your salesperson.<p class="paragraph"/><h4>Configure your environment for GemFire.</h4>
<ol>
<li>Set the <code>JAVA_HOME</code> environment variable to point to your Java runtime installation. (There should be a bin directory under <code>JAVA_HOME</code>.)</li>
<li>Set the <code>GEMFIRE</code> environment variable to point to your GemFire installation top-level directory. (There should be bin, lib, dtd, and other directories under GEMFIRE.)</li>
<li>Configure <code>GF_JAVA</code> and your <code>PATH</code> and <code>CLASSPATH</code> as shown in these examples. (<code>GF_JAVA</code> must point to the java executable file under your <code>JAVA_HOME</code>.)</li>
</ol><p class="paragraph"/><h4>Unix Bourne and Korn shells (sh, ksh, bash)</h4><p class="paragraph"/><div class="code"><pre>GF_JAVA=$JAVA_HOME/bin/java;export GF_JAVA
PATH=$PATH:$JAVA_HOME/bin:$GEMFIRE/bin;export PATH
CLASSPATH=$GEMFIRE/lib/gemfire.jar:$GEMFIRE/lib/antlr.jar:$GEMFIRE/lib/gfSecurityImpl.jar:$CLASSPATH;export CLASSPATH</pre></div><p class="paragraph"/><h4>Windows</h4><p class="paragraph"/><div class="code"><pre>set GF_JAVA=%JAVA_HOME%&#98;in&#106;ava.exe
set PATH=%PATH%;%JAVA_HOME%&#98;in;%GEMFIRE%&#98;in
set CLASSPATH=%GEMFIRE%&#108;ib&#103;emfire.jar;%GEMFIRE%&#108;ib&#97;ntlr.jar;%GEMFIRE%&#108;ib&#103;fSecurityImpl.jar;%CLASSPATH%</pre></div>



<h1 id="2. Cache Regions">2 Cache Regions</h1>
GemFire allows your data to be organized within a cache using data regions.  The
Grails GemFire plugin provides a DSL for describing the regions available to
the application and provides a simple convention based approach to accessing
regions.


<h2 id="2.1 Cache Region Configuration">2.1 Cache Region Configuration</h2>
GemFire regions may be described in <code>Config.groovy</code> by assigning a value to
the <code>grails.gemfire.regions</code> property.  The value should be a closure which
contains GemFire Region DSL code.  Details about the DSL are described below.<p class="paragraph"/>The code below declares 2 regions with the names <code>region1</code> and <code>region2</code>.<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy
grails.gemfire.regions = &#123;<p class="paragraph"/>    // declare region1
    region1()<p class="paragraph"/>    // declare region2
    region2()
&#125;</pre></div><p class="paragraph"/>Regions may be configured with a syntax like this:<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy<p class="paragraph"/><span class="java&#45;keyword">import</span> com.gemstone.gemfire.cache.DataPolicy<p class="paragraph"/>grails.gemfire.regions = &#123;<p class="paragraph"/>    region1 &#123;
        // configure region1&#8230;
        dataPolicy = DataPolicy.REPLICATE
        publisher = <span class="java&#45;keyword">false</span>
    &#125;<p class="paragraph"/>    region2 &#123;
        // configure region2&#8230;
        dataPolicy = DataPolicy.PARTITION
    &#125;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/>The DSL supports all of the configuration attributes which are supported by the 
<a href="http://www.gemstone.com/docs/6.0.1/product/docs/japi/com/gemstone/gemfire/cache/AttributesFactory.html" target="blank">AttributesFactory</a>.<p class="paragraph"/>The DSL provides some syntax to simplify the configuration and eliminate 
explicit references to GemFire classes like <code>DataPolicy</code>.  The previous 
example could be written like this:<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy<p class="paragraph"/>grails.gemfire.regions = &#123;<p class="paragraph"/>    region1 &#123;
        // configure region1&#8230;
        dataPolicy = REPLICATE
        publisher = <span class="java&#45;keyword">false</span>
    &#125;<p class="paragraph"/>    region2 &#123;
        // configure region2&#8230;
        dataPolicy = PARTITION
    &#125;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/>The following table lists all of the properties which may be referenced
directly without a class prefix.<p class="paragraph"/><table class="wiki-table" cellpadding="0" cellspacing="0" border="0"><tr><th><strong class="bold">Class</strong></th><th><strong class="bold">Property Name</strong></th></tr><tr class="table-odd"><td>com.gemstone.gemfire.cache.DataPolicy</td><td>EMPTY</td></tr><tr class="table-even"><td>com.gemstone.gemfire.cache.DataPolicy</td><td>NORMAL</td></tr><tr class="table-odd"><td>com.gemstone.gemfire.cache.DataPolicy</td><td>PARTITION</td></tr><tr class="table-even"><td>com.gemstone.gemfire.cache.DataPolicy</td><td>PERSISTENT_REPLICATE</td></tr><tr class="table-odd"><td>com.gemstone.gemfire.cache.DataPolicy</td><td>PRELOADED</td></tr><tr class="table-even"><td>com.gemstone.gemfire.cache.DataPolicy</td><td>REPLICATE</td></tr><tr class="table-odd"><td>com.gemstone.gemfire.cache.ExpirationAction</td><td>DESTROY</td></tr><tr class="table-even"><td>com.gemstone.gemfire.cache.ExpirationAction</td><td>INVALIDATE</td></tr><tr class="table-odd"><td>com.gemstone.gemfire.cache.ExpirationAction</td><td>LOCAL_DESTROY</td></tr><tr class="table-even"><td>com.gemstone.gemfire.cache.ExpirationAction</td><td>LOCAL_INVALIDATE</td></tr><tr class="table-odd"><td>com.gemstone.gemfire.cache.Scope</td><td>DISTRIBUTED_ACK</td></tr><tr class="table-even"><td>com.gemstone.gemfire.cache.Scope</td><td>DISTRIBUTED_NO_ACK</td></tr><tr class="table-odd"><td>com.gemstone.gemfire.cache.Scope</td><td>GLOBAL</td></tr><tr class="table-even"><td>com.gemstone.gemfire.cache.Scope</td><td>LOCAL</td></tr></table><p class="paragraph"/>Several properties require an instance of the 
<a href="http://www.gemstone.com/docs/6.0.1/product/docs/japi/com/gemstone/gemfire/cache/ExpirationAttributes.html" target="blank">ExpirationAttributes</a>
class.  These include <code>regionTimeToLive</code>, <code>regionIdleTimeout</code>, <code>entryTimeToLive</code> and <code>entryIdleTimeout</code>.  Configuring those
properties might look something like this:<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy
<span class="java&#45;keyword">import</span> com.gemstone.gemfire.cache.ExpirationAction
<span class="java&#45;keyword">import</span> com.gemstone.gemfire.cache.ExpirationAttributes<p class="paragraph"/>grails.gemfire.regions = &#123;<p class="paragraph"/>    region1 &#123;
        entryTimeToLive = <span class="java&#45;keyword">new</span> ExpirationAttributes(120)
        entryTimeToIdle = <span class="java&#45;keyword">new</span> ExpirationAttributes(200, ExpirationAction.DESTROY)
    &#125;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/>The DSLS allows the explicit references to the <code>ExpirationAction</code> and <code>ExpirationAttributes</code> classes 
to be removed.<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy<p class="paragraph"/>grails.gemfire.regions = &#123;<p class="paragraph"/>    region1 &#123;
        entryTimeToLive = expirationAttributes(120)
        entryTimeToIdle = expirationAttributes(200, DESTROY)
    &#125;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/>


<h2 id="2.2 Accesing Cache Regions">2.2 Accesing Cache Regions</h2>
For each configured cache region a bean is added to the Spring application 
context with a corresponding name.  Those beans are the simplest way  
to interact with the cache region.  The bean may be treated as a map
of key value pairs.<p class="paragraph"/>If a region were configured like this:<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy<p class="paragraph"/>grails.gemfire.regions = &#123;<p class="paragraph"/>    departmentData &#123;
        entryTimeToLive = expirationAttributes(120)
    &#125;<p class="paragraph"/>&#125;</pre></div><p class="paragraph"/>It could be accessed like this:<p class="paragraph"/><div class="code"><pre>// grails&#45;app/controllers/com/demo/ReportingController.groovy<p class="paragraph"/><span class="java&#45;keyword">package</span> com.demo<p class="paragraph"/>class ReportingController &#123;<p class="paragraph"/>    def departmentData<p class="paragraph"/>    def index = &#123;
        def hrData = departmentData&#91;'hr'&#93;
        def accountData = departmentData&#91;'accounting'&#93;<p class="paragraph"/>        // &#8230;
    &#125;<p class="paragraph"/>    def addToCache = &#123;
        def key = params.key
        def value = params.value
        departmentData&#91;key&#93; = value<p class="paragraph"/>        redirect action: 'list'
    &#125;<p class="paragraph"/>    // &#8230;
&#125;</pre></div><p class="paragraph"/><p class="paragraph"/><p class="paragraph"/>


<h1 id="3. Cache Servers">3 Cache Servers</h1>
Gemfire supports a client / server mode for caching which can unlock some of the nicer Gemfire features including:
<ul class="star">
<li>Grid computing</li>
<li>Continuous querying</li>
<li>Advanced data partitioning</li>
</ul><p class="paragraph"/>In order to use client/server mode you need to <a href="../guide/single.html#1.1%20Installing%20Gemfire" class="guide">install gemfire</a> as per the documentation.<p class="paragraph"/>This plugin provides scripts to start up cache servers and locators.<p class="paragraph"/>To startup cache servers you can use the <code>start-cache-server</code> command.<p class="paragraph"/><div class="code"><pre>grails start&#45;cache&#45;server server1</pre></div><p class="paragraph"/>You can stop a server again using the <code>stop-cache-server</code> command:<p class="paragraph"/><div class="code"><pre>grails stop&#45;cache&#45;server server1</pre></div><p class="paragraph"/>The port of the server is automatically assigned. If you want to specify the port, locator server or multicast options there are more advanced arguments:<p class="paragraph"/><div class="code"><pre>grails start&#45;cache&#45;server server1 &#45;&#45;locators=localhost&#91;4111&#93; &#45;&#45;port=41112 &#45;&#45;mcast&#45;port=0</pre></div><p class="paragraph"/>If the multicast port (mcast-port) option is set to 0 then multicast is disabled. If you disable multicast then you will need to setup a locator server.<p class="paragraph"/>You can setup a locator by running the <code>start-locator</code> command:<p class="paragraph"/><div class="code"><pre>grails start&#45;locator</pre></div><p class="paragraph"/>This will start the locator on port 55221 by default. If you wish to start the locator service on a different port you can use:<p class="paragraph"/><div class="code"><pre>grails start&#45;locator &#45;&#45;port=4111</pre></div><p class="paragraph"/>A locator is responsible for looking up the location of cache servers. If you don't use a locator then the default multicast lookup will happen.<p class="paragraph"/>


<h2 id="3.1 Cache Server Clients">3.1 Cache Server Clients</h2>
Once you have some cache servers up and running you need to configure the Grails application to act as a client to the servers.<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy
grails.gemfire.servers = &#123;    
	myServer &#123;
		properties = &#91;'log&#45;level': 'warning'&#93;
		pool &#123;
			addServer <span class="java&#45;quote">"localhost"</span>, 4111
			setMinConnections 1
			setMaxConnections 20
			setRetryAttempts 10
			setSubscriptionEnabled <span class="java&#45;keyword">true</span>
		&#125;
	&#125;
&#125;</pre></div><p class="paragraph"/>The example above using a single cache server. If you plan to use multiple cache servers then you can specify one or many locators.<p class="paragraph"/><div class="code"><pre>// grails&#45;app/conf/Config.groovy
grails.gemfire.servers = &#123;    
	myServer &#123;
		properties = &#91;'log&#45;level': 'warning'&#93;
		pool &#123;
			addLocator <span class="java&#45;quote">"localhost"</span>, 4111
			setMinConnections 1
			setMaxConnections 20
			setRetryAttempts 10
			setSubscriptionEnabled <span class="java&#45;keyword">true</span>
		&#125;
	&#125;
&#125;</pre></div><p class="paragraph"/>If you want to use continuous queries make sure that <code>subscriptionEnabled</code> is set to true on the pool. For all the configuration options see the <a href="http://www.gemstone.com/docs/6.5.0/product/docs/japi/com/gemstone/gemfire/cache/client/class-use/PoolFactory.html" target="blank">PoolFactory</a> API in the Gemfire documentation

                    </div>
                </td>
                <td id="col2">
            <div class="local clearfix">
                <div class="local-title">
                    <a href="../guide/index.html" target="mainFrame">Quick Reference</a>
                    <span class="toggle">(<a href="#" onclick="localToggle(); return false;">hide</a>)</span>
                </div>
                <div class="menu">
                    
                    <div class="menu-block"><h1 class="menu-title" onclick="toggleRef(this.parentNode.childNodes[1])">Command Line</h1><div class="menu-sub">
                        
                        
                        <div class="menu-item"><a href="../ref/Command%20Line/gemfire-generate.html">gemfire-generate</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Command%20Line/start-cache-server.html">start-cache-server</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Command%20Line/start-locator.html">start-locator</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Command%20Line/stop-cache-server.html">stop-cache-server</a>
                        </div>
                        
                        <div class="menu-item"><a href="../ref/Command%20Line/stop-locator.html">stop-locator</a>
                        </div>
                        
                        </div>
                    </div>
                    
                </div>
            </div>
        </td>
            </tr>
        </table>

        <div id="footer">
            
            
        </div>



<script type="text/javascript" src="../js/docs.js"></script>

    </body>
</html>
