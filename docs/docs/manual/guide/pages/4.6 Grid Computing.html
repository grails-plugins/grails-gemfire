<html>
    <head>
        <meta http-equiv="Content-type" content="text/html; charset=utf-8"/>
        <title>4.6 Grid Computing</title>
        <link rel="stylesheet" href="../css/main.css" type="text/css" media="screen" title="Ref" charset="utf-8"/>
    </head>
    <body class="body">
    Using a partitioned topology Gemfire will store a primary version of an entity on one node and a backup on another node. This means that a particular entity might be stored on a completely different machine to where the client is running.<p class="paragraph"/>You may want to execute some logic that manipulates the primary version of an entity. This is where Gemfire's function execution functionality comes in handy.<p class="paragraph"/>For example say you save an entity on one node in the Grid:<p class="paragraph"/><div class="code"><pre>def p = <span class="java&#45;keyword">new</span> Plant(name:<span class="java&#45;quote">"cabbage"</span>, goesInPatch:<span class="java&#45;keyword">true</span>).save()</pre></div><p class="paragraph"/>You can later execute a function that operates on the local data where the node is stored using the <code>executeFunction</code> method:<p class="paragraph"/><div class="code"><pre>def results = Plant.executeFunction(&#91;p.id&#93;) &#123; ctx &#45;&#62;
  ctx.lastResult ctx.localData&#91;ctx.filter.iterator().next()&#93;
&#125;
assert results&#91;0&#93;.name == 'cabbage'</pre></div><p class="paragraph"/>The <code>executeFunction</code> method takes a <code>List</code> (which acts as a filter to specify which entities you want to execute the function for) and a closure which is the function to execute.<p class="paragraph"/>What actually happens is the Groovy closure is serialized across the grid and executed on the node where the data exists. The <code>ctx.localData</code> variable gives you access to the data stored locally on the node.<p class="paragraph"/>In this example we're just returning the data from the function as part of the execution by calling the <code>lastResult</code> method on the <a href="http://www.gemstone.com/docs/current/product/docs/japi/com/gemstone/gemfire/cache/execute/RegionFunctionContext.html" target="blank">FunctionContext</a> which relays to the <a href="http://www.gemstone.com/docs/current/product/docs/japi/com/gemstone/gemfire/cache/execute/ResultSender.html" target="blank">ResultSender</a><p class="paragraph"/>
Using this mechanism you can implement typical grid computing patterns such as Map/Reduce.<p class="paragraph"/>
    </body>
</html>
